jQuery(document).ready(function(p){"use strict";p.wp_content_pilot={init:function(){p("#_campaign_type").on("change",this.triggerCampaignTypeChange),p("body").on("change","#_post_from",this.toggleKeywordsField),p("body").bind("campaign_type_changed",this.getCampaignOptions),p("body").bind("campaign_type_changed",this.getPostSettings),p("body").bind("campaign_type_changed",this.getCampaignAllTemplateTags),p("body").on("click",".wpcp-delete-all",this.deleteAllPostedPosts),this.repeatableInput()},initPlugins:function(){p(".ever-select-chosen").chosen({inherit_select_classes:!0})},triggerCampaignTypeChange:function(){var t=p(this).val(),e=p("#post_ID").val();if(t&&e){var n={campaign_type:t,post_id:e,type:t};p("body").trigger("campaign_type_changed",n)}},getCampaignOptions:function(t,e){wp.ajax.send({data:{action:"wpcp_get_campaign_options_metabox_content",campaign_type:e.type,post_id:e.post_id,nonce:""},success:function(t){p("#campaign-options .inside").html(t)},error:function(t){alert("Something happend wrong"),console.log(t)}})},getPostSettings:function(t,e){wp.ajax.send({data:{action:"wpcp_get_campaign_post_settings_metabox_content",campaign_type:e.type,post_id:e.post_id,nonce:""},success:function(t){p("#campaign-post-settings .inside").html(t),p("body").trigger("wpcpcontentloaded")},error:function(t){alert("Something happend wrong"),console.log(t)}})},getCampaignAllTemplateTags:function(t,e){wp.ajax.send({data:{action:"wpcp_get_campaign_template_tags_metabox_content",campaign_type:e.type,post_id:e.post_id,nonce:""},success:function(t){p("#campaign-template-tags .inside").html(t),p("body").trigger("wpcpcontentloaded")},error:function(t){alert("Something happend wrong"),console.log(t)}})},repeatableInput:function(){var i=Date.now();p("body").on("click",".wpcp-add-field",function(t){t.preventDefault();var e=p(this).data("tmpl"),n=p("#"+e),a=p(this).prev(),o=n.html();o=o.replace(/ITEM_ID/g,(++i).toString(36)),a.append(o)}),p("body").on("click",".wpcp-repeatable-delete",function(t){t.preventDefault();var e=p(this).parents(".wpcp-repeatable-field");confirm("Yes delete it")&&e.remove()})},deleteAllPostedPosts:function(t){if(t.preventDefault(),confirm("Are you sure?")){var e=p(this),n=p(this).next(),a=e.data("camp-id"),o=e.data("nonce");e.attr("disabled",!0),n.addClass("active"),e.attr("disabled",!0),n.addClass("active"),wp.ajax.send({data:{action:"wpcp_delete_all_posts_by_campaign_id",camp_id:a,nonce:o},success:function(t){n.removeClass("active"),e.attr("disabled",!1),console.log(t),n.removeClass("active"),e.attr("disabled",!1),window.location.reload()},error:function(t){n.removeClass("active"),e.attr("disabled",!1),alert("Something happend wrong"),console.log(t)}})}},getCampaignDefaultTemplateTags:function(t,e){wp.ajax.send({data:{action:"wpcp_get_campaign_default_template_tags",campaign_type:e.type,post_id:e.post_id},success:function(t){console.log(t),p("#_post_template").text(t)},error:function(t){alert("Something happend wrong"),console.log(t)}})},toggleKeywordsField:function(){var t=p("#_post_from");if(t.length){var e=p("#_keywords"),n=p("._keywords_field");"global"!==t.val()?(n.hide("fast"),e.removeAttr("required")):(n.show("fast"),e.attr("required",!0))}}},p.wp_content_pilot.init(),p.wp_content_pilot.initPlugins(),p.wp_content_pilot.toggleKeywordsField()});